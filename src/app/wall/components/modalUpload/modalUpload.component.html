
<div #modalDiv
  class="main-modal fixed w-full h-auto inset-0 z-50 overflow-hidden justify-center items-center animated faster"
  [ngClass]="modalUploadService.visible() ? 'flex fadeIn' : 'hidden fadeOut' " style="background: rgba(0,0,0,.7);">
  <div
    class="border border-teal-500 modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto">
    <div class="modal-content py-4  px-6">
      <!--Title-->
      <div class=" flex justify-between items-center pb-3">
        <p class="text-2xl font-bold ">
          @switch (this.typeModal) {
          @case ('newpost') {
          New Post
          }
          @case ('changeavatar') {
          New Avatar
          }
          }
        </p>
        <div class="modal-close cursor-pointer z-50" (click)="closeModal()">
          <svg class="fill-current text-black" xmlns="http://www.w3.org/2000/svg" width="18" height="18"
            viewBox="0 0 18 18">
            <path
              d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z">
            </path>
          </svg>
        </div>
      </div>
      <!--Body-->

      @if (this.typeModal === 'newpost') {

      <form [formGroup]="newPostForm" (ngSubmit)="onCreatePost()">


        <div class="grid grid-cols-[88%_12%] md:grid-cols-[92%_8%] relative my-5 w-full">

          <input #txtMessage formControlName="text"
            class="text-left text-sm md:text-base p-2 rounded-lg text-gray-600 focus:outline-none"
            placeholder="What's on your mind, {{this.authService.user()?.userName}}?">

          <app-emoji (onSelectedEmoji)="addEmojiToInput($event)"></app-emoji>
        </div>



        <div class="grid my-5 w-full">
          <div class="flex justify-center items-center">
            <img *ngIf="!imgTemp()" [src]="this.modalUploadService.img " class="cursor-pointer"
              (click)="fileInput.click()">
            <img *ngIf="imgTemp()" [src]="imgTemp()" class="w-auto max-h-[50vh]" (click)="fileInput.click()">
          </div>

          <input hidden type="file" #fileInput (change)="onUploadImage($event, true)">
        </div>

        <button type="submit" class=" w-full focus:outline-none px-4 bg-teal-500 p-3 ml-3 rounded-lg text-white"
          [ngClass]="{ 'hover:bg-teal-400 cursor-pointer': imgToUpload()}">Create Post</button>

      </form>

      } @else {

      <div class="grid my-5 w-full">
        <div class="flex justify-center items-center">
          <img *ngIf="!imgTemp()" [src]="this.authService.user()!.avatar || this.modalUploadService.img"
            class="cursor-pointer w-auto md:max-h-[50vh] " (click)="fileInput.click()">
          <img *ngIf="imgTemp()" [src]="imgTemp()" class="w-auto md:max-h-[50vh]" (click)="fileInput.click()">
        </div>

        <input hidden type="file" #fileInput (change)="onUploadImage($event, false)">
      </div>
      <div class="flex justify-end pt-2">
        <button (click)="onChangeAvatar()" [disabled]="!imgToUpload()"
          class=" w-full focus:outline-none px-4 bg-teal-500 p-3 ml-3 rounded-lg text-white"
          [ngClass]="{ 'hover:bg-teal-400 cursor-pointer': imgToUpload()}">Change Avatar</button>
      </div>
      }






    </div>
  </div>
</div>


@if (this.loading()) {

<div class="w-full h-full fixed top-0 left-0 bg-white opacity-75 z-50">
  <div class="flex justify-center items-center mt-[50vh]">
    <div class="fas fa-circle-notch fa-spin fa-5x text-violet-600"></div>
  </div>
</div>
}
